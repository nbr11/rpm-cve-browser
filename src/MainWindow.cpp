#include "MainWindow.hpp"
#include "ui_MainWindow.h"

#include <QTimer>

MainWindow::MainWindow(QWidget *parent)
  : QMainWindow(parent)
    , m_pUi(new Ui::MainWindow)
    , m_pProgressTimer(new QTimer(this))
    , m_progressCount(0)
    , m_progressTick(0)
{
    m_pUi->setupUi(this);

    m_pUi->processingDial->setDisabled(true);

    m_pProgressTimer->setInterval(20);

    connect(m_pProgressTimer, SIGNAL(timeout()), this, SLOT(updateProgress()));

}

MainWindow::~MainWindow()
{
    delete m_pUi;
}

void MainWindow::incrementProgressCount()
{
    // If 0 start timer
    if (m_progressCount == 0)
    {
        m_pProgressTimer->start();

        m_pUi->processingLabel->setText(tr("Processing ..."));
    }
    m_progressCount += 1;
}

void MainWindow::decrementProgressCount()
{
    if (m_progressCount > 0)
    {
        m_progressCount -= 1;
    }

    // If count back to 0 stop progress
    if (m_progressCount == 0)
    {
        m_pProgressTimer->stop();

        m_pUi->processingLabel->setText("");

        m_progressTick = 0;
        m_pUi->processingDial->setValue(m_progressTick);
    }
}

void MainWindow::updateProgress()
{
    m_progressTick += 2;
    m_pUi->processingDial->setValue(m_progressTick);
}

